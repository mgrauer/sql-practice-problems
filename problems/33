select customerid, sum(unitprice*quantity) as customeramount from orders join orderdetails using(orderid) where extract(YEAR from orderdate) = 2016 group by customerid having sum(unitprice*quantity)::numeric > 15000 order by customeramount desc;
