with latecounts (employeeid, latecount) as (select employeeid, count(*) as latecount from orders where shippeddate >= requireddate group by employeeid order by latecount desc),  ordercounts (employeeid, ordercount) as (select employeeid, count(*) as ordercount from orders group by employeeid)                                                                                                              select employeeid, ordercount, COALESCE(latecount, 0) from ordercounts left join latecounts using (employeeid) order by coalesce(latecount, 0) desc;
