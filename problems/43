with latecounts (employeeid, latecount) as (select employeeid, count(*) as latecount from orders where shippeddate >= requireddate group by employeeid order by latecount desc),  ordercounts (employeeid, ordercount) as (select employeeid, count(*) as ordercount from orders group by employeeid)                                                              select employeeid, ordercount, latecount, latecount::numeric / ordercount::numeric as fraclate from ordercounts join latecounts using (employeeid) order by fraclate desc;
