with highvals as (select customerid, companyname, sum(unitprice*quantity) as totalorderamount from orders join orderdetails using(orderid) join customers using (customerid) where extract(YEAR from orderdate) = 2016 group by  customerid, companyname order by totalorderamount desc) select *, case when totalorderamount::numeric > 10000 then 'high' when totalorderamount::numeric <= 10000 and totalorderamount::numeric > 5000 then 'medium' else 'low' end as customergroup from highvals;
